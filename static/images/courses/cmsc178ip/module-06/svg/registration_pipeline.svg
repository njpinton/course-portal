<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 380" role="img" aria-label="Complete image registration pipeline">
  <title>Image Registration Pipeline</title>
  <desc>Step-by-step process for aligning two images using feature-based registration</desc>

  <defs>
    <linearGradient id="regBg" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f8f9fa"/>
      <stop offset="100%" style="stop-color:#e9ecef"/>
    </linearGradient>
    <marker id="regArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1a3a6e"/>
    </marker>
  </defs>

  <rect width="850" height="380" fill="url(#regBg)" rx="8"/>

  <!-- Title -->
  <text x="425" y="32" fill="#1a3a6e" font-family="Segoe UI, sans-serif" font-size="20" font-weight="600" text-anchor="middle">Image Registration Pipeline</text>

  <!-- Pipeline steps -->
  <!-- Step 1: Input Images -->
  <g transform="translate(25, 65)">
    <rect x="0" y="0" width="120" height="145" fill="white" rx="6" stroke="#666" stroke-width="2"/>
    <text x="60" y="18" fill="#666" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" text-anchor="middle">Input Images</text>

    <!-- Reference image -->
    <g transform="translate(10, 28)">
      <rect x="0" y="0" width="45" height="35" fill="#3b82f6" opacity="0.3" stroke="#3b82f6" rx="2"/>
      <text x="22" y="50" fill="#3b82f6" font-family="Segoe UI, sans-serif" font-size="7" text-anchor="middle">Reference</text>
    </g>

    <!-- Moving image -->
    <g transform="translate(65, 28)">
      <g transform="rotate(-15, 22, 17)">
        <rect x="0" y="0" width="45" height="35" fill="#f97316" opacity="0.3" stroke="#f97316" rx="2"/>
      </g>
      <text x="22" y="50" fill="#f97316" font-family="Segoe UI, sans-serif" font-size="7" text-anchor="middle">Moving</text>
    </g>

    <!-- Misaligned overlay indicator -->
    <g transform="translate(30, 90)">
      <rect x="0" y="0" width="60" height="40" fill="#f8f9fa" stroke="#ccc" rx="2"/>
      <rect x="5" y="5" width="25" height="20" fill="#3b82f6" opacity="0.4"/>
      <g transform="rotate(-10, 40, 20)">
        <rect x="25" y="10" width="25" height="20" fill="#f97316" opacity="0.4"/>
      </g>
      <text x="30" y="52" fill="#666" font-family="Segoe UI, sans-serif" font-size="7" text-anchor="middle">Misaligned</text>
    </g>
  </g>

  <!-- Arrow -->
  <line x1="150" y1="137" x2="170" y2="137" stroke="#1a3a6e" stroke-width="2" marker-end="url(#regArrow)"/>

  <!-- Step 2: Feature Detection -->
  <g transform="translate(175, 65)">
    <rect x="0" y="0" width="120" height="145" fill="white" rx="6" stroke="#3b82f6" stroke-width="2"/>
    <text x="60" y="18" fill="#3b82f6" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" text-anchor="middle">1. Detect Features</text>

    <g transform="translate(10, 30)">
      <rect x="0" y="0" width="100" height="60" fill="#e5e7eb" rx="3"/>
      <!-- Feature points -->
      <circle cx="20" cy="15" r="4" fill="#ef4444"/>
      <circle cx="50" cy="12" r="4" fill="#ef4444"/>
      <circle cx="80" cy="18" r="4" fill="#ef4444"/>
      <circle cx="25" cy="40" r="4" fill="#ef4444"/>
      <circle cx="55" cy="45" r="4" fill="#ef4444"/>
      <circle cx="75" cy="38" r="4" fill="#ef4444"/>
    </g>

    <text x="60" y="105" fill="#666" font-family="Segoe UI, sans-serif" font-size="8" text-anchor="middle">SIFT, ORB, Harris</text>
    <text x="60" y="118" fill="#666" font-family="Segoe UI, sans-serif" font-size="8" text-anchor="middle">corners, edges</text>
    <text x="60" y="135" fill="#3b82f6" font-family="Segoe UI, sans-serif" font-size="8" text-anchor="middle">Keypoints + Descriptors</text>
  </g>

  <!-- Arrow -->
  <line x1="300" y1="137" x2="320" y2="137" stroke="#1a3a6e" stroke-width="2" marker-end="url(#regArrow)"/>

  <!-- Step 3: Feature Matching -->
  <g transform="translate(325, 65)">
    <rect x="0" y="0" width="120" height="145" fill="white" rx="6" stroke="#10b981" stroke-width="2"/>
    <text x="60" y="18" fill="#10b981" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" text-anchor="middle">2. Match Features</text>

    <g transform="translate(10, 30)">
      <!-- Two images side by side -->
      <rect x="0" y="0" width="40" height="60" fill="#dbeafe" rx="2"/>
      <rect x="60" y="0" width="40" height="60" fill="#fed7aa" rx="2"/>

      <!-- Match lines -->
      <line x1="10" y1="15" x2="70" y2="12" stroke="#10b981" stroke-width="1"/>
      <line x1="25" y1="25" x2="85" y2="20" stroke="#10b981" stroke-width="1"/>
      <line x1="15" y1="40" x2="75" y2="45" stroke="#10b981" stroke-width="1"/>
      <line x1="30" y1="50" x2="80" y2="52" stroke="#10b981" stroke-width="1"/>

      <!-- Points -->
      <circle cx="10" cy="15" r="3" fill="#3b82f6"/>
      <circle cx="25" cy="25" r="3" fill="#3b82f6"/>
      <circle cx="15" cy="40" r="3" fill="#3b82f6"/>
      <circle cx="30" cy="50" r="3" fill="#3b82f6"/>
      <circle cx="70" cy="12" r="3" fill="#f97316"/>
      <circle cx="85" cy="20" r="3" fill="#f97316"/>
      <circle cx="75" cy="45" r="3" fill="#f97316"/>
      <circle cx="80" cy="52" r="3" fill="#f97316"/>
    </g>

    <text x="60" y="105" fill="#666" font-family="Segoe UI, sans-serif" font-size="8" text-anchor="middle">BFMatcher, FLANN</text>
    <text x="60" y="118" fill="#666" font-family="Segoe UI, sans-serif" font-size="8" text-anchor="middle">Ratio test filtering</text>
    <text x="60" y="135" fill="#10b981" font-family="Segoe UI, sans-serif" font-size="8" text-anchor="middle">Correspondences</text>
  </g>

  <!-- Arrow -->
  <line x1="450" y1="137" x2="470" y2="137" stroke="#1a3a6e" stroke-width="2" marker-end="url(#regArrow)"/>

  <!-- Step 4: Estimate Transform -->
  <g transform="translate(475, 65)">
    <rect x="0" y="0" width="120" height="145" fill="white" rx="6" stroke="#f97316" stroke-width="2"/>
    <text x="60" y="18" fill="#f97316" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" text-anchor="middle">3. Estimate H</text>

    <g transform="translate(15, 35)">
      <rect x="0" y="0" width="90" height="50" fill="#fed7aa" rx="3"/>
      <text x="45" y="18" fill="#333" font-family="Segoe UI, sans-serif" font-size="9" text-anchor="middle">[h₁₁ h₁₂ h₁₃]</text>
      <text x="45" y="32" fill="#333" font-family="Segoe UI, sans-serif" font-size="9" text-anchor="middle">[h₂₁ h₂₂ h₂₃]</text>
      <text x="45" y="46" fill="#333" font-family="Segoe UI, sans-serif" font-size="9" text-anchor="middle">[h₃₁ h₃₂ h₃₃]</text>
    </g>

    <text x="60" y="105" fill="#666" font-family="Segoe UI, sans-serif" font-size="8" text-anchor="middle">RANSAC for outliers</text>
    <text x="60" y="118" fill="#666" font-family="Segoe UI, sans-serif" font-size="8" text-anchor="middle">Least squares fit</text>
    <text x="60" y="135" fill="#f97316" font-family="Segoe UI, sans-serif" font-size="8" text-anchor="middle">Homography matrix</text>
  </g>

  <!-- Arrow -->
  <line x1="600" y1="137" x2="620" y2="137" stroke="#1a3a6e" stroke-width="2" marker-end="url(#regArrow)"/>

  <!-- Step 5: Warp & Blend -->
  <g transform="translate(625, 65)">
    <rect x="0" y="0" width="120" height="145" fill="white" rx="6" stroke="#7c3aed" stroke-width="2"/>
    <text x="60" y="18" fill="#7c3aed" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" text-anchor="middle">4. Warp & Blend</text>

    <g transform="translate(10, 30)">
      <rect x="0" y="0" width="100" height="60" fill="#f8f9fa" stroke="#ccc" rx="3"/>
      <!-- Aligned overlay -->
      <rect x="15" y="10" width="35" height="25" fill="#3b82f6" opacity="0.5"/>
      <rect x="40" y="20" width="35" height="25" fill="#f97316" opacity="0.5"/>
      <!-- Overlap region -->
      <rect x="40" y="20" width="10" height="15" fill="#7c3aed" opacity="0.5"/>
    </g>

    <text x="60" y="105" fill="#666" font-family="Segoe UI, sans-serif" font-size="8" text-anchor="middle">cv2.warpPerspective</text>
    <text x="60" y="118" fill="#666" font-family="Segoe UI, sans-serif" font-size="8" text-anchor="middle">Feather blending</text>
    <text x="60" y="135" fill="#7c3aed" font-family="Segoe UI, sans-serif" font-size="8" text-anchor="middle">Registered result</text>
  </g>

  <!-- Result indication -->
  <g transform="translate(750, 100)">
    <rect x="0" y="0" width="75" height="75" fill="#ecfdf5" rx="6" stroke="#10b981" stroke-width="2"/>
    <text x="37" y="18" fill="#10b981" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" text-anchor="middle">Output</text>
    <rect x="12" y="25" width="50" height="40" fill="#10b981" opacity="0.3" stroke="#10b981" rx="2"/>
    <text x="37" y="50" fill="#10b981" font-family="Segoe UI, sans-serif" font-size="8" text-anchor="middle">Aligned!</text>
  </g>

  <!-- Bottom summary -->
  <g transform="translate(25, 230)">
    <rect x="0" y="0" width="800" height="130" fill="white" rx="8" stroke="#1a3a6e" stroke-width="2"/>
    <text x="400" y="25" fill="#1a3a6e" font-family="Segoe UI, sans-serif" font-size="13" font-weight="600" text-anchor="middle">Registration Methods Summary</text>

    <!-- Feature-based -->
    <g transform="translate(20, 45)">
      <rect x="0" y="0" width="240" height="70" fill="#dbeafe" rx="4"/>
      <text x="120" y="18" fill="#3b82f6" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" text-anchor="middle">Feature-Based (shown above)</text>
      <text x="10" y="35" fill="#666" font-family="Segoe UI, sans-serif" font-size="9">• Fast, works well with texture</text>
      <text x="10" y="50" fill="#666" font-family="Segoe UI, sans-serif" font-size="9">• Handles large displacements</text>
      <text x="10" y="65" fill="#666" font-family="Segoe UI, sans-serif" font-size="9">• May fail on low-texture images</text>
    </g>

    <!-- Intensity-based -->
    <g transform="translate(280, 45)">
      <rect x="0" y="0" width="240" height="70" fill="#d1fae5" rx="4"/>
      <text x="120" y="18" fill="#10b981" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" text-anchor="middle">Intensity-Based (correlation)</text>
      <text x="10" y="35" fill="#666" font-family="Segoe UI, sans-serif" font-size="9">• Optimizes similarity metric</text>
      <text x="10" y="50" fill="#666" font-family="Segoe UI, sans-serif" font-size="9">• Good for medical imaging</text>
      <text x="10" y="65" fill="#666" font-family="Segoe UI, sans-serif" font-size="9">• Slower, local minima risk</text>
    </g>

    <!-- Deep learning -->
    <g transform="translate(540, 45)">
      <rect x="0" y="0" width="240" height="70" fill="#ede9fe" rx="4"/>
      <text x="120" y="18" fill="#7c3aed" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" text-anchor="middle">Deep Learning</text>
      <text x="10" y="35" fill="#666" font-family="Segoe UI, sans-serif" font-size="9">• End-to-end learned features</text>
      <text x="10" y="50" fill="#666" font-family="Segoe UI, sans-serif" font-size="9">• SuperPoint, SuperGlue</text>
      <text x="10" y="65" fill="#666" font-family="Segoe UI, sans-serif" font-size="9">• Best accuracy, needs GPU</text>
    </g>
  </g>
</svg>
