<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 400" role="img" aria-label="Composition of multiple transformations through matrix multiplication">
  <title>Transformation Composition</title>
  <desc>How multiple transformations combine through matrix multiplication, demonstrating order matters</desc>

  <defs>
    <linearGradient id="compBg" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f8f9fa"/>
      <stop offset="100%" style="stop-color:#e9ecef"/>
    </linearGradient>
    <marker id="compArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1a3a6e"/>
    </marker>
  </defs>

  <rect width="850" height="400" fill="url(#compBg)" rx="8"/>

  <!-- Title -->
  <text x="425" y="32" fill="#1a3a6e" font-family="Segoe UI, sans-serif" font-size="20" font-weight="600" text-anchor="middle">Transformation Composition</text>

  <!-- Key concept -->
  <g transform="translate(200, 50)">
    <rect x="0" y="0" width="450" height="40" fill="white" rx="6" stroke="#1a3a6e" stroke-width="2"/>
    <text x="225" y="26" fill="#1a3a6e" font-family="Segoe UI, sans-serif" font-size="14" font-weight="600" text-anchor="middle">T_combined = T₃ × T₂ × T₁  (applied right to left)</text>
  </g>

  <!-- Example: Rotate around point (not origin) -->
  <g transform="translate(30, 110)">
    <rect x="0" y="0" width="790" height="140" fill="white" rx="8" stroke="#3b82f6" stroke-width="2"/>
    <text x="395" y="25" fill="#3b82f6" font-family="Segoe UI, sans-serif" font-size="13" font-weight="600" text-anchor="middle">Example: Rotate 45° around point P(100, 50)</text>

    <!-- Step 1 -->
    <g transform="translate(20, 45)">
      <rect x="0" y="0" width="180" height="80" fill="#dbeafe" rx="4"/>
      <text x="90" y="18" fill="#3b82f6" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" text-anchor="middle">Step 1: Translate P to origin</text>
      <text x="90" y="40" fill="#333" font-family="Segoe UI, sans-serif" font-size="11" text-anchor="middle">T₁ = Translate(-100, -50)</text>
      <text x="90" y="60" fill="#666" font-family="Segoe UI, sans-serif" font-size="9" text-anchor="middle">[1 0 -100]</text>
      <text x="90" y="72" fill="#666" font-family="Segoe UI, sans-serif" font-size="9" text-anchor="middle">[0 1 -50]</text>
    </g>

    <!-- Arrow -->
    <path d="M205,85 L225,85" stroke="#1a3a6e" stroke-width="2" marker-end="url(#compArrow)"/>

    <!-- Step 2 -->
    <g transform="translate(230, 45)">
      <rect x="0" y="0" width="180" height="80" fill="#d1fae5" rx="4"/>
      <text x="90" y="18" fill="#10b981" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" text-anchor="middle">Step 2: Rotate at origin</text>
      <text x="90" y="40" fill="#333" font-family="Segoe UI, sans-serif" font-size="11" text-anchor="middle">T₂ = Rotate(45°)</text>
      <text x="90" y="60" fill="#666" font-family="Segoe UI, sans-serif" font-size="9" text-anchor="middle">[cos45 -sin45 0]</text>
      <text x="90" y="72" fill="#666" font-family="Segoe UI, sans-serif" font-size="9" text-anchor="middle">[sin45 cos45 0]</text>
    </g>

    <!-- Arrow -->
    <path d="M415,85 L435,85" stroke="#1a3a6e" stroke-width="2" marker-end="url(#compArrow)"/>

    <!-- Step 3 -->
    <g transform="translate(440, 45)">
      <rect x="0" y="0" width="180" height="80" fill="#fed7aa" rx="4"/>
      <text x="90" y="18" fill="#f97316" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" text-anchor="middle">Step 3: Translate back</text>
      <text x="90" y="40" fill="#333" font-family="Segoe UI, sans-serif" font-size="11" text-anchor="middle">T₃ = Translate(100, 50)</text>
      <text x="90" y="60" fill="#666" font-family="Segoe UI, sans-serif" font-size="9" text-anchor="middle">[1 0 100]</text>
      <text x="90" y="72" fill="#666" font-family="Segoe UI, sans-serif" font-size="9" text-anchor="middle">[0 1 50]</text>
    </g>

    <!-- Arrow -->
    <path d="M625,85 L645,85" stroke="#1a3a6e" stroke-width="2" marker-end="url(#compArrow)"/>

    <!-- Combined -->
    <g transform="translate(650, 45)">
      <rect x="0" y="0" width="120" height="80" fill="#ede9fe" rx="4" stroke="#7c3aed" stroke-width="2"/>
      <text x="60" y="18" fill="#7c3aed" font-family="Segoe UI, sans-serif" font-size="10" font-weight="600" text-anchor="middle">Combined!</text>
      <text x="60" y="40" fill="#333" font-family="Segoe UI, sans-serif" font-size="10" text-anchor="middle">T = T₃×T₂×T₁</text>
      <text x="60" y="60" fill="#666" font-family="Segoe UI, sans-serif" font-size="9" text-anchor="middle">Single 3×3</text>
      <text x="60" y="72" fill="#666" font-family="Segoe UI, sans-serif" font-size="9" text-anchor="middle">matrix</text>
    </g>
  </g>

  <!-- Order matters demonstration -->
  <g transform="translate(30, 270)">
    <rect x="0" y="0" width="790" height="115" fill="white" rx="8" stroke="#ef4444" stroke-width="2"/>
    <text x="395" y="25" fill="#ef4444" font-family="Segoe UI, sans-serif" font-size="13" font-weight="600" text-anchor="middle">⚠ Order Matters! (Matrix multiplication is not commutative)</text>

    <!-- Example A: Rotate then Translate -->
    <g transform="translate(30, 40)">
      <text x="0" y="15" fill="#333" font-family="Segoe UI, sans-serif" font-size="11" font-weight="600">Rotate then Translate:</text>

      <g transform="translate(0, 25)">
        <rect x="0" y="0" width="30" height="30" fill="#3b82f6" rx="2"/>
        <text x="50" y="20" fill="#333" font-family="Segoe UI, sans-serif" font-size="14">→</text>
        <g transform="translate(70, 0)">
          <g transform="rotate(45, 15, 15)">
            <rect x="0" y="0" width="30" height="30" fill="#3b82f6" rx="2"/>
          </g>
        </g>
        <text x="120" y="20" fill="#333" font-family="Segoe UI, sans-serif" font-size="14">→</text>
        <g transform="translate(170, -15)">
          <g transform="rotate(45, 15, 15)">
            <rect x="0" y="0" width="30" height="30" fill="#3b82f6" rx="2"/>
          </g>
        </g>
      </g>
      <text x="100" y="70" fill="#666" font-family="Segoe UI, sans-serif" font-size="9" text-anchor="middle">T×R: Rotate first, then shift</text>
    </g>

    <!-- vs -->
    <text x="395" y="75" fill="#ef4444" font-family="Segoe UI, sans-serif" font-size="16" font-weight="600" text-anchor="middle">≠</text>

    <!-- Example B: Translate then Rotate -->
    <g transform="translate(500, 40)">
      <text x="0" y="15" fill="#333" font-family="Segoe UI, sans-serif" font-size="11" font-weight="600">Translate then Rotate:</text>

      <g transform="translate(0, 25)">
        <rect x="0" y="0" width="30" height="30" fill="#10b981" rx="2"/>
        <text x="50" y="20" fill="#333" font-family="Segoe UI, sans-serif" font-size="14">→</text>
        <rect x="90" y="-20" width="30" height="30" fill="#10b981" rx="2"/>
        <text x="140" y="20" fill="#333" font-family="Segoe UI, sans-serif" font-size="14">→</text>
        <g transform="translate(170, 0) rotate(45, 15, 15)">
          <rect x="-30" y="-40" width="30" height="30" fill="#10b981" rx="2"/>
        </g>
      </g>
      <text x="100" y="70" fill="#666" font-family="Segoe UI, sans-serif" font-size="9" text-anchor="middle">R×T: Shift first, rotates around origin</text>
    </g>
  </g>
</svg>
