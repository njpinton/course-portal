<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 420" role="img" aria-label="Precision-Recall curve for computing Average Precision (AP)">
  <title>Precision-Recall Curve and Average Precision</title>
  <desc>Chart showing precision-recall curve with area under curve representing AP, used for computing mAP</desc>

  <defs>
    <linearGradient id="prBg" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f8f9fa"/>
      <stop offset="100%" style="stop-color:#e9ecef"/>
    </linearGradient>
    <linearGradient id="apFill" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:0.3"/>
      <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:0.1"/>
    </linearGradient>
  </defs>

  <rect width="800" height="420" fill="url(#prBg)" rx="8"/>

  <!-- Title -->
  <text x="400" y="35" fill="#1a3a6e" font-family="Segoe UI, sans-serif" font-size="18" font-weight="600" text-anchor="middle">Precision-Recall Curve and Average Precision (AP)</text>

  <!-- Chart area -->
  <g transform="translate(80, 60)">
    <!-- Grid -->
    <g stroke="#dee2e6" stroke-width="1" opacity="0.5">
      <line x1="0" y1="0" x2="400" y2="0"/>
      <line x1="0" y1="80" x2="400" y2="80"/>
      <line x1="0" y1="160" x2="400" y2="160"/>
      <line x1="0" y1="240" x2="400" y2="240"/>
      <line x1="0" y1="320" x2="400" y2="320"/>
      <line x1="0" y1="0" x2="0" y2="320"/>
      <line x1="100" y1="0" x2="100" y2="320"/>
      <line x1="200" y1="0" x2="200" y2="320"/>
      <line x1="300" y1="0" x2="300" y2="320"/>
      <line x1="400" y1="0" x2="400" y2="320"/>
    </g>

    <!-- Axes -->
    <line x1="0" y1="320" x2="400" y2="320" stroke="#1a3a6e" stroke-width="2"/>
    <line x1="0" y1="0" x2="0" y2="320" stroke="#1a3a6e" stroke-width="2"/>

    <!-- Axis labels -->
    <text x="200" y="360" fill="#1a3a6e" font-family="Segoe UI, sans-serif" font-size="14" font-weight="600" text-anchor="middle">Recall</text>
    <text x="-35" y="160" fill="#1a3a6e" font-family="Segoe UI, sans-serif" font-size="14" font-weight="600" text-anchor="middle" transform="rotate(-90, -35, 160)">Precision</text>

    <!-- X-axis ticks -->
    <text x="0" y="340" fill="#666" font-family="Segoe UI, sans-serif" font-size="12" text-anchor="middle">0.0</text>
    <text x="100" y="340" fill="#666" font-family="Segoe UI, sans-serif" font-size="12" text-anchor="middle">0.25</text>
    <text x="200" y="340" fill="#666" font-family="Segoe UI, sans-serif" font-size="12" text-anchor="middle">0.5</text>
    <text x="300" y="340" fill="#666" font-family="Segoe UI, sans-serif" font-size="12" text-anchor="middle">0.75</text>
    <text x="400" y="340" fill="#666" font-family="Segoe UI, sans-serif" font-size="12" text-anchor="middle">1.0</text>

    <!-- Y-axis ticks -->
    <text x="-10" y="5" fill="#666" font-family="Segoe UI, sans-serif" font-size="12" text-anchor="end">1.0</text>
    <text x="-10" y="85" fill="#666" font-family="Segoe UI, sans-serif" font-size="12" text-anchor="end">0.75</text>
    <text x="-10" y="165" fill="#666" font-family="Segoe UI, sans-serif" font-size="12" text-anchor="end">0.5</text>
    <text x="-10" y="245" fill="#666" font-family="Segoe UI, sans-serif" font-size="12" text-anchor="end">0.25</text>
    <text x="-10" y="325" fill="#666" font-family="Segoe UI, sans-serif" font-size="12" text-anchor="end">0.0</text>

    <!-- Area under curve (AP visualization) -->
    <path d="M0,0 L0,16 L40,16 L40,48 L100,48 L100,80 L160,80 L160,112 L220,112 L220,160 L280,160 L280,224 L340,224 L340,288 L400,288 L400,320 L0,320 Z"
          fill="url(#apFill)"/>

    <!-- Precision-Recall curve (interpolated) -->
    <path d="M0,0 L0,16 L40,16 L40,48 L100,48 L100,80 L160,80 L160,112 L220,112 L220,160 L280,160 L280,224 L340,224 L340,288 L400,288"
          fill="none" stroke="#3b82f6" stroke-width="3" stroke-linecap="round"/>

    <!-- Raw PR curve (with drops) -->
    <path d="M0,8 Q20,20 40,32 Q60,50 80,64 Q100,85 120,96 Q150,110 180,128 Q210,150 240,176 Q270,200 300,232 Q340,270 380,296 L400,304"
          fill="none" stroke="#f97316" stroke-width="2" stroke-dasharray="6,3" opacity="0.7"/>

    <!-- AP annotation -->
    <g transform="translate(180, 200)">
      <rect x="-5" y="-20" width="90" height="45" fill="white" rx="4" stroke="#3b82f6" stroke-width="1"/>
      <text x="40" y="0" fill="#3b82f6" font-family="Segoe UI, sans-serif" font-size="12" font-weight="600" text-anchor="middle">AP = 0.72</text>
      <text x="40" y="18" fill="#666" font-family="Segoe UI, sans-serif" font-size="10" text-anchor="middle">(area under)</text>
    </g>
  </g>

  <!-- Right panel: Explanation -->
  <g transform="translate(520, 70)">
    <rect x="0" y="0" width="250" height="290" fill="white" rx="8" stroke="#e5e7eb"/>

    <text x="125" y="25" fill="#1a3a6e" font-family="Segoe UI, sans-serif" font-size="14" font-weight="600" text-anchor="middle">Computing mAP</text>

    <g transform="translate(15, 50)">
      <text x="0" y="0" fill="#333" font-family="Segoe UI, sans-serif" font-size="12" font-weight="600">1. For each class:</text>
      <text x="10" y="20" fill="#666" font-family="Segoe UI, sans-serif" font-size="11">Sort detections by confidence</text>
      <text x="10" y="38" fill="#666" font-family="Segoe UI, sans-serif" font-size="11">Compute P/R at each threshold</text>
      <text x="10" y="56" fill="#666" font-family="Segoe UI, sans-serif" font-size="11">Interpolate precision</text>
      <text x="10" y="74" fill="#666" font-family="Segoe UI, sans-serif" font-size="11">AP = area under curve</text>

      <text x="0" y="105" fill="#333" font-family="Segoe UI, sans-serif" font-size="12" font-weight="600">2. Mean over classes:</text>
      <text x="10" y="125" fill="#1a3a6e" font-family="Segoe UI, sans-serif" font-size="12">mAP = (1/C) * Sum(APi)</text>

      <g transform="translate(0, 150)">
        <text x="0" y="0" fill="#333" font-family="Segoe UI, sans-serif" font-size="12" font-weight="600">Legend:</text>
        <line x1="0" y1="20" x2="30" y2="20" stroke="#3b82f6" stroke-width="3"/>
        <text x="40" y="25" fill="#333" font-family="Segoe UI, sans-serif" font-size="11">Interpolated</text>
        <line x1="0" y1="45" x2="30" y2="45" stroke="#f97316" stroke-width="2" stroke-dasharray="6,3"/>
        <text x="40" y="50" fill="#333" font-family="Segoe UI, sans-serif" font-size="11">Raw curve</text>
        <rect x="0" y="65" width="30" height="15" fill="url(#apFill)" stroke="#3b82f6" stroke-width="1"/>
        <text x="40" y="77" fill="#333" font-family="Segoe UI, sans-serif" font-size="11">AP area</text>
      </g>
    </g>
  </g>

  <!-- Bottom note -->
  <text x="400" y="400" fill="#666" font-family="Segoe UI, sans-serif" font-size="12" text-anchor="middle">
    mAP@0.5 uses IoU threshold of 0.5 | mAP@[.5:.95] averages over multiple IoU thresholds
  </text>
</svg>